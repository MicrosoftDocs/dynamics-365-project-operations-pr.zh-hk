---
title: 擴充時間項目
description: 本主題提供有關開發人員如何擴充時間項目控制項的資訊。
author: stsporen
ms.date: 01/27/2022
ms.topic: article
ms.reviewer: johnmichalak
ms.author: stsporen
ms.openlocfilehash: 6b91aecd76950d2bd37192d634c80ea98d08034e
ms.sourcegitcommit: c0792bd65d92db25e0e8864879a19c4b93efb10c
ms.translationtype: HT
ms.contentlocale: zh-HK
ms.lasthandoff: 04/14/2022
ms.locfileid: "8583013"
---
# <a name="extending-time-entries"></a>擴充時間項目

_**適用於：** 資源/非庫存型案例適用的 Project Operations、精簡部署 - 交易至開立預估發票_

Dynamics 365 Project Operations 包含可擴充的時間項目自訂控制項。 此控制項包含下列功能：

- 輸入橫跨一週的時間
- 依日、列或週的總計
- 複製列或週
- 透過 HH:mm 或 HH.hh (自動轉換為 HH.hh) 輸入的時間項目
- 從指派、預約或約會匯入

時間項目可在兩個區域中進行擴充：
- [新增自訂時間項目供自己使用](#add)
- [自訂每週時間項目控制項](#customize)

## <a name="add-custom-time-entries-for-your-own-use"></a><a name="add"></a>新增自訂時間項目供自己使用

時間項目是多個案例中所使用的核心實體。 在 2020 年 4 月第 1 段浪潮中，推出了 TESA 核心解決方案。 TESA 提供 **設定** 實體以及新的 **時間項目使用者** 資訊安全角色。 其中也包含與 **msdyn_duration** 有直接關聯的新欄位 **msdyn_start** 和 **msdyn_end**。 新的實體、資訊安全角色及欄位讓您有更統一的方法可以跨多個產品處理時間。


### <a name="time-source-entity"></a>時間來源實體
| 欄位 | 描述 | 
|-------|------------|
| 名字  | 時間來源實體的名稱會在建立時間項目時用來做為選取值。 |
| 預設時間來源 [時間來源：isdefault] | 根據預設，能以預設標示的僅限一個時間來源。 這允許項目預設為時間來源 (如果未指定的話)。 |
|時間來源類型 [時間來源：sourcetype] | 來源類型是允許將時間來源關聯至應用程式的選項 (時間項目來源類型)。 Microsoft 會保留大於 190,000,000 的值。|


### <a name="time-entries-and-the-time-source-entity"></a>時間項目和時間來源實體
每個時間項目都會與時間來源記錄建立關聯。 此記錄決定要處理時間項目的應用程式及其處理方式。

時間項目永遠都是一個已連結開始、結束及期間的時間連續區塊。

邏輯會自動在下列情況中更新時間項目記錄：

- 如果提供下列三個欄位中的兩個，則會自動計算第三個欄位： 

    - **msdyn_start**
    - **msdyn_end**
    - **msdyn_duration**

- **msdyn_start** 和 **msdyn_end** 欄位會感知時區。
- 僅使用指定的 **msdyn_date** 和 **msdyn_duration** 所建立的時間項目將會從午夜開始。 **msdyn_start** 和 **msdyn_end** 欄位也會相應更新。

#### <a name="time-entry-types"></a>時間項目類型

時間項目記錄的關聯類型會定義相關聯應用程式在提交流程中的行為。

|標籤 | 值|
|-----|-----|
|休息   |192,355,000|
|差旅 | 192,355,001|
|加班時間   | 192,354,320|
|工作   | 192,350,000|
|缺席    | 192,350,001|
|休假   | 192,350,002|


## <a name="customize-the-weekly-time-entry-control"></a><a name="customize"></a>自訂每週時間項目控制項
開發人員可以將額外的欄位和查詢新增至其他實體，並實作自訂商務規則以支援其業務案例。

### <a name="add-custom-fields-with-lookups-to-other-entities"></a>新增具有其他實體查詢的自訂欄位
有三個主要步驟將自訂欄位新增至每週時間輸入網格。

1. 將自訂欄位新增至 **快速建立** 對話方塊。
2. 設定網格以顯示自訂欄位。
3. 視情況而定，將自訂欄位新增至 **列編輯** 或 **時間項目編輯** 頁面。

確定新欄位在 **列編輯** 或 **時間項目編輯** 頁面中有必要的驗證。 在此工作中，根據時間項目的狀態鎖定欄位。

將自訂欄位新增至 **時間項目** 網格，然後直接在網格中建立時間項目時，系統會自動設定這些項目的自訂欄位，使其與該列相符。 

### <a name="add-the-custom-field-to-the-quick-create-dialog-box"></a>將自訂欄位新增至 [快速建立] 對話方塊
將自訂欄位新增至 **快速建立：建立時間項目** 對話方塊。 使用者可以接著在新增時間項目時，選取 **新增** 來輸入值。

### <a name="configure-the-grid-to-show-the-custom-field"></a>設定網格以顯示自訂欄位
有兩個方法可以將自訂欄位新增至 **每週時間項目** 網格：

- 自訂 **我的每週時間項目** 檢視表，並將自訂欄位新增至其中。 您可以在檢視表中編輯這些屬性，以指定網格中自訂欄位的位置和大小。
- 建立新的自訂時間項目檢視表，並將其設定為預設檢視表。 除了您要包含在網格中的欄位之外，此檢視表也應包含 **描述** 及 **外部註解** 欄位。 您可以在檢視表中編輯這些屬性，以指定網格的位置、大小和預設排序順序。 接下來，設定此檢視表的自訂控制項，使其成為 **時間輸入網格** 控制項。 將控制項新增至檢視表，然後選取此控制項以用於 **網頁**、**手機** 及 **平板電腦**。 接下來，設定 **每週時間項目** 網格的參數。 將 **開始日期** 欄位設定為 **msdyn\_date**、將 **期間** 欄位設定為 **msdyn\_duration**，並將 **狀態** 欄位設定為 **msdyn\_entrystatus**。 **唯讀狀態清單** 欄位會設定成 **192350002 (已核准)**、**192350003 (已提交)** 或 **192350004 (已要求回收)**。

### <a name="add-the-custom-field-to-the-appropriate-edit-page"></a>將自訂欄位新增至適當的編輯頁面
可以在 **表單** 下方找到用來編輯時間項目或一列時間項目的頁面。 網格中的 **編輯項目** 按鈕會開啟 **編輯項目** 頁面，而 **編輯列** 按鈕則會開啟 **列編輯** 頁面。 您可以編輯這些頁面，使其包含自訂欄位。

這兩個選項都會移除 **專案** 與 **專案工作** 實體中的一些現成可用篩選，讓實體的所有查詢檢視表都能看得見。 在預設情況下，只會顯示相關的查詢檢視表。

您必須為自訂欄位判斷適當的頁面。 最有可能的情況是，如果您將欄位新增至網格，則該欄位應該會出現在用於套用至整列時間項目之欄位的 **列編輯** 頁面。 如果自訂欄位每天在該列中都會有唯一值 (例如，這是結束時間的自訂欄位時)，則此欄位應該會出現在 **時間項目編輯** 頁面上。

若要將自訂欄位新增至頁面，請將 **欄位** 元素拖曳至頁面的適當位置，然後設定其屬性。

### <a name="add-new-option-set-values"></a>新增選項組值
若要將選項組值新增至現成可用的欄位，請執行下列步驟。

1. 開啟欄位的編輯頁面，然後在 **類型** 底下選取選項組旁邊的 **編輯**。
2. 新增具有自訂標籤與色彩的新選項。 如果您想要加入新的時間項目狀態，請將現成可用欄位命名為 **項目狀態**。

### <a name="designate-a-new-time-entry-status-as-read-only"></a>將新的時間項目狀態指定為唯讀
若要將新的時間項目狀態指定為唯讀，請將新的時間項目值新增至 **唯讀狀態清單** 屬性。 請務必新增數字，而不是標籤。 現在會針對有新狀態的列，鎖定其時間項目網格的可編輯組件。 若要以其他方式設定不同 **時間項目** 檢視表的 **唯讀狀態清單** 屬性，請在檢視表的 **自訂控制項** 區段中新增 **時間項目** 網格，並視需要設定參數。

接下來，新增商務規則以鎖定 **列編輯** 和 **時間項目編輯** 頁面上的所有欄位。 若要存取這些頁面的商務規則，請開啟每個頁面的表單編輯器，然後選取 **商務規則**。 您可以將新狀態新增至現有商務規則中的條件，也可以為新狀態新增商務規則。

### <a name="add-custom-validation-rules"></a>新增自訂驗證規則
您可以為 **每週時間項目** 網格體驗新增兩種類型的驗證規則：

- 在頁面上使用的用戶端商務規則
- 套用至所有時間項目更新的伺服器端外掛程式驗證

#### <a name="client-side-business-rules"></a>用戶端商務規則
使用商務規則鎖定和解除鎖定欄位、在欄位中輸入預設值，然後定義驗證，要求資訊只能來自目前時間項目記錄。 若要存取頁面的商務規則，請開啟表單編輯器，然後選取 **商務規則**。 您可以接著編輯現有的商務規則，或新增商務規則。

#### <a name="server-side-plug-in-validations"></a>伺服器端外掛程式驗證
對於任何需要內容超過單一時間項目記錄所能提供範圍的驗證，您應該使用外掛程式驗證。 您也應該將這些驗證用於任何要在網格中對內嵌更新執行的驗證。 若要完成驗證，請在 **時間項目** 實體上建立自訂外掛程式。

### <a name="limits"></a>限制
**時間項目** 網格目前的大小限制為 500 列。 如果其中超過 500 列，則不會顯示多餘的列。 無法增加此大小限制。

### <a name="copying-time-entries"></a>複製時間項目
使用 **複製時間項目欄** 檢視表來定義要在時間輸入期間複製的欄位清單。 **日期** 和 **期間** 是必要欄位，不可從檢視表移除。


[!INCLUDE[footer-include](../includes/footer-banner.md)]
