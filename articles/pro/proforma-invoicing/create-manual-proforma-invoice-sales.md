---
title: 專案預估發票
description: 本主題提供有關 Project Operations 中專案預估發票的資訊。
author: rumant
manager: Annbe
ms.date: 04/06/2021
ms.topic: article
ms.prod: ''
ms.service: project-operations
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: d08e2b0422a991aa4c98ae5d1e0f60aa0eb9daa6
ms.sourcegitcommit: ca0fc078d1a12484eca193fe051b8442c0559db8
ms.translationtype: HT
ms.contentlocale: zh-HK
ms.lasthandoff: 04/07/2021
ms.locfileid: "5867203"
---
# <a name="proforma-project-pnvoices"></a>專案預估發票

_**適用於：** 精簡部署 - 交易至開立預估發票_

開立專案預估發票讓專案經理在為客戶建立發票前有另一層級的核准。 第一層核准是在專案團隊成員送出的時間、費用和材料項目經過核准時完成。

Dynamics 365 Project Operations 精簡部署不是為了產生客戶面向發票而設計。 下列清單顯示無法產生發票的原因：

- 未包含稅務資訊。
- 無法將其他貨幣轉換為發票貨幣。
- 無法正確設定列印發票的格式。

但您可以改用財務或會計系統來建立客戶面向發票，使用所產生發票提案中的資訊。

## <a name="creating-project-invoices"></a>建立專案發票

您可以一次建立一份專案發票，或是大量建立。 您可以手動建立專案發票，也可以進行設定以便在自動執行中產生。

### <a name="manually-create-project-invoices"></a>手動建立專案發票 

在 **專案合約** 清單頁面上，您可以分別為每個專案合約建立專案發票，或者可以為多個專案合約大量建立發票。

   - 若要為特定專案合約建立發票，請在 **專案合約** 清單頁面上開啟專案合約，然後選取 **建立發票**。

   發票會針對狀態為 **已準備好開立發票** 的所選專案合約的所有交易來產生。 這些交易包含時間、費用、材料、里程碑、產品型合約服務內容，以及其他可能已確認的未開單銷售帳目明細。

若要大量建立發票：

1. 在 **專案合約** 清單頁面上，選取一個或多個要為其建立發票的專案合約，然後選取 **建立專案發票**。
2. 出現一則警告訊息通知您，建立發票之前可能會有一段延遲。 也會顯示程序。 選取 **確定** 以關閉訊息方塊。

   發票會針對狀態為 **已準備好開立發票** 的合約服務內容的所有交易來產生。 這些交易包含時間、費用、材料、里程碑、產品型合約服務內容，以及其他可能已確認的未開單銷售帳目明細。

3. 移至 **銷售**\>**帳務**\>**發票**，以檢視所產生的發票。 您會看到每個專案合約的一份發票。

### <a name="set-up-automated-creation-of-project-invoices"></a>設定自動建立專案發票 

依照下列步驟設定自動化發票執行。

1. 移至 **設定** \> **批次工作**。
2. 建立批次工作，並將其命名為 **Project Operations 建立發票**。 批次工作的名稱必須包含「建立發票」一詞。
3. 在 **工作類型** 欄位中，選取 **無**。 **每日頻率** 和 **使用中** 選項預設會設定為 **是**。
4. 選取 **執行工作流程**。 在 **查詢記錄** 對話方塊中，您會看到下列工作流程：

    - ProcessRunCaller
    - ProcessRunner
    - UpdateRoleUtilization

5. 選取 **ProcessRunCaller**，然後選取 **新增**。
6. 在下一個對話方塊中選取 **確定**。 **睡眠** 工作流程後面會跟著 **程序** 工作流程。

    您也可以選取步驟 5 中的 **ProcessRunner**。 然後，當您選取 **確定** 時，**程序** 工作流程後面會接著 **睡眠** 工作流程。

**ProcessRunCaller** 和 **ProcessRunner** 工作流程會建立發票。 **ProcessRunCaller** 會呼叫 **ProcessRunner**。 **ProcessRunner** 是建立發票的工作流程。 此工作流程會處理所有需要建立發票的合約服務內容，然後建立發票。 為了確定必須建立其發票的合約服務內容，工作流程會查看合約服務內容的發票執行日期。 如果屬於一個合約的合約服務內容具有相同的發票執行日期，則會將交易合併成一個有兩個發票明細的發票。 如果沒有要為其建立發票的交易，則不會建立任何發票。

**ProcessRunner** 執行完畢後，會呼叫 **ProcessRunCaller**、提供結束時間，然後關閉。 **ProcessRunCaller** 接著啟動計時器，從指定的結束時間開始執行 24 小時。 計時器結束時，會關閉 **ProcessRunCaller**。

用於建立發票的批次處理工作是週期性工作。 如果此批次處理已執行多次，就會建立工作的多個執行個體，並且可能造成錯誤。 若要解決此問題，您只能啟動批次處理一次，並且只有在其停止執行時才要加以重新啟動。

> [!NOTE]
> 批次開立發票只會對發票排程所設定的專案合約服務內容來執行。 使用固定價格計費方式的合約服務內容必須已設定里程碑。 使用時間和材料計費方式的專案合約服務內容必須設定以日期為依據的發票排程。 這同樣適用於專案型合約服務內容。      
 
### <a name="edit-a-draft-invoice"></a>編輯草稿發票

建立草稿專案發票時，所有在時間及費用項目獲核准時建立的未開單銷售交易都會提取到發票上。 發票仍處於草稿階段時，您可以進行下列調整：

- 刪除或編輯發票明細詳細資料。
- 編輯和調整數量與帳單類型。
- 直接將時間、費用、材料和服務費新增為發票上的交易。 如果發票明細對應至允許這些交易分類的合約服務內容，您可以使用此功能。

選取 **確認** 以確認發票。 此動作是單向動作。 選取 **確認** 時，發票會變成唯讀，並從每個發票明細的每個發票明細詳細資料建立已開單銷售實際值。 如果發票明細詳細資料參考了未開單銷售，則會沖回未開單銷售實際值。 任何從時間、費用或材料使用項目建立的發票明細詳細資料，都會參考未開單銷售實際值。 總帳整合系統可使用此沖銷來沖回進行中專案工作 (WIP) 以作會計用途。

### <a name="correct-a-confirmed-invoice"></a>更正已確認的發票

您可以編輯已確認的發票。 更正已確認發票時，會建立新的草稿更正發票。 因為假設您要從原始發票中沖回所有交易和數量，此更正發票會包含原始發票中的所有交易，而其上所有數量皆為零。

如果有不需要更正的交易，您可以從草稿更正發票移除這些交易。 如果您想要沖回或回復部分數量，則可以編輯明細詳細資料上的 **數量** 欄位。 如果開啟發票明細詳細資料，您可以查看原始發票數量。 然後就可以編輯目前發票數量，使其小於或等於原始發票數量。

確認更正發票時，會沖回原始已開單銷售實際值，並建立新的已開單銷售實際值。 如果數量已扣減，則差額會導致建立新的未開單銷售實際值。 例如，如果原始已開單銷售是八小時，且更正發票明細詳細資料的數量已減少為六小時，則會沖回原始已開單銷售明細，並建立兩個新的實際值：

- 六小時的已開單銷售實際。
- 剩餘兩個小時的未開單銷售實際值。 視與客戶的協商而定，此交易可以稍後再開帳單，或標示為不應收費。



[!INCLUDE[footer-include](../../includes/footer-banner.md)]
